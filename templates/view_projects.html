<!DOCTYPE html>
<html>
<head>
    <title>View Projects and Materials</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h2>Your Projects</h2>
        {% for project in projects %}
            <h3>Project ID: {{ project[0] }} | Name: {{ project[1] }}</h3>
            <p>Status: {{ project[2] }} | Cost/Sq: {{ project[3] }} | Area: {{ project[4] }}</p>
            <p>Start: {{ project[5] }} | End: {{ project[6] }}</p>

            {% if customer_by_project[project[0]] %}
                <p><strong>Customer:</strong> {{ customer_by_project[project[0]][1] }} | {{ customer_by_project[project[0]][2] }}</p>
            {% else %}
                <p><strong>No Customer Assigned</strong></p>
                <form method="POST" action="{{ url_for('add_customer_to_project', pid=project[0]) }}">
                    <label>Name:</label><input type="text" name="cname" required>
                    <label>Phone:</label><input type="text" name="phone_no" required>
                    <label>Address:</label><input type="text" name="address" required>
                    <label>Email:</label><input type="email" name="email" required>
                    <label>Budget:</label><input type="number" name="budget" required>
                    <button type="submit">Add Customer</button>
                </form>
    <a href="{{ url_for('contractor_dashboard') }}">Back to Dashboard</a>
            {% endif %}

            <a href="{{ url_for('add_material', pid=project[0]) }}">‚ûï Add Material</a>
            <a href="{{ url_for('edit_project', pid=project[0]) }}">‚úèÔ∏è Edit Project</a>
            <a href="{{ url_for('delete_project', pid=project[0]) }}">üóëÔ∏è Delete Project</a>

            <table>
                <thead>
                    <tr>
                        <th>Material ID</th>
                        <th>Name</th>
                        <th>Quantity</th>
                        <th>Cost</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                {% for material in materials_by_project[project[0]] %}
                    <tr>
                        <td>{{ material[0] }}</td>
                        <td>{{ material[2] }}</td>
                        <td>{{ material[3] }}</td>
                        <td>{{ material[4] }}</td>
                        <td>
                            <a href="{{ url_for('edit_material', mid=material[0]) }}">Edit</a> |
                            <a href="{{ url_for('delete_material', mid=material[0], pid=project[0]) }}">Delete</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <hr>
        {% endfor %}
    <a href="{{ url_for('contractor_dashboard') }}">Back to Dashboard</a>
    </div>
</body>
</html>
